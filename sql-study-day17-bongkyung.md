## 13 - 1 데이터베이스를 위한 데이터를 저장한 데이터 사전
<br/>

>데이터 사전이란?

- 오라클 데이터베이스 테이블은 사용자 테이블(user table)과 데이터 사전(data dictionary)으로 나뉜다.
    - 사용자 테이블은 데이터베이스를 통해 관리할 데이터를 저장하는 테이블을 뜻한다. 앞에서 여러 SQL문에서 활용한 EMP, DEPT, SALGRADE 테이블이 바로 사용자 테이블이다.
    <br/>
    
    - 데이터 사전은 데이터베이스를 구성하고 운영하는 데 필요한 모든 정보를 저장하는 특수한 테이블로 데이터베이스가 생성되는 시점에 자동으로 만들어진다.
    데이터 사전에는 데이터베이스 메모리·성능·사용자·권한·객체 등 오라클 데이터베이스 운영에 중요한 데이터가 보관되어 있다. 만약 이 데이터에 문제가 발생한다면 오라클 데이터베이스 사용이 불가능해질 수도 있다.
    따라서 오라클 데이터베이스는 사용자가 데이터 사전 정보에 직접 접근하거나 작업하는 것을 허용하지 않는다. 그 대신 데이터 사전 뷰(data dictionary view)를 제공하여 SELECT문으로 정보 열람을 할 수 있다.

<br/>

- 데이터 사전 뷰는 용도에 따라 이름 앞에 다음과 같은 접두어를 지정하여 분류한다.

| 접두어 | 설명 |
|:-----:|:-------------:|
| USER_XXXX | 현재 데이터베이스에 접속한 사용자가 소유한 객체 정보 |
| ALL_XXXX | 현재 데이터베이스에 접속한 사용자가 소유한 객체 또는 다른 사용자가 소유한 객체 중 사용 허가를 받은 객체, 즉 사용 가능한 모든 객체 정보 |
| DBA_XXXX | 데이터베이스 관리를 위한 정보(데이터베이스 관리 권한을 가진 SYSTEM, SYS 사용자만 열람 가능) |
| V$_XXXX | 데이터베이스 성능 관련 정보(X$_XXXX 테이블의 뷰) |

<br/>

⭐ 사용 가능한 데이터 사전을 알고 싶다면 다음과 같이 DICTIONARY 또는 DICT를 조회한다.
```sql
// SCOTT 계정에서 사용 가능한 데이터 사전 살펴보기(DICT 사용)
SELECT * FROM DICT;

// SCOTT 계정에서 사용 가능한 데이터 사전 살펴보기(DICTIONARY 사용)
SELEC * FROM DICTIONARY;
```
<br/>

> USER_접두어를 가진 데이터 사전

- USER_ 접두어로 시작하는 이름의 데이터 사전에는 현재 오라클에 접속해 있는 사용자가 소유한 객체 정보가 보관되어 있다.
```sql
// SCOTT 계정이 가지고 있는 객체 정보 살펴보기(USER_접두어 사용)
SELECT TABLE_NAME
  FROM USER_TABLES;
```
<br/>

> ALL_ 접두어를 가진 데이터 사전

- ALL_ 접두어를 가진 데이터 사전은 오라클 데이터베이스에 접속해 있는 사용자가 소유한 객체 및 다른 사용자가 소유한 객체 중 사용이 허락되어 있는 객체 정보를 가지고 있다.
```sql
// SCOTT 계정이 사용할 수 있는 객체 정보 살펴보기(ALL_ 접두어 사용)
SELECT OWNER, TABLE_NAME
  FROM ALL_TABLES;
```
ALL_TABLES에는 USER_TABLES와 달리 OWNER열이 하나 더 있다. 이 열은 테이블을 소유한 사용자를 명시한다.

| 열 이름 | 자료형 | NULL 여부 | 설명 |
|:------:|:------:|:--------:|:----:|
| OWNER | VARCHAR2(30) | NOT NULL | 테이블을 소유한 사용자 (ALL_TABLES에만 존재) |
| TABLE_NAME | VARCHAR(30) | NOT NULL | 테이블 이름 |
| TABLESPACE_NAME | VARCHAR(30) | | 테이블 스페이스 이름 |
| NUM_ROWS | NUMBER | | 테이블에 저장된 행 수 |

<br/>

> DBA_ 접두어를 가진 데이터 사전

- DBA_ 접두어를 가진 데이터 사전은 데이터베이스 관리 권한을 가진 사용자만 조회할 수 있는 테이블로서 SCOTT 계정으로는 조회가 불가능하다.
```sql
// SCOTT 계정으로 DBA_ 접두어 사용하기
SELECT * FROM DBA_TABLES;
```

<br/>

## 13 - 2 더 빠른 검색을 위한 인덱스
<br/>

> 인덱스란?

- 색인이라는 뜻의 인덱스(index)는 책 내용을 찾는 것과 마찬가지로 오라클 데이터베이스에서 데이터 검색 성능의 향상을 위해 테이블 열에 사용하는 객체를 뜻한다. 테이브렝 보관된 특정 행 데이터의 주소, 즉 위치 정보를 책 페이지처럼 목록으로 만들어 놓은 것이다. 인덱스는 테이블 열을 여러 가지 분석을 통해 선정하여 설정할 수 있다.
   - Table Full Scan : 테이블 데이터를 처음부터 끝까지 검색하여 원하는 데이터를 찾는 방식
   - Index Scan : 인덱스를 통해 데이터를 찾는 방식
<br/>

- 인덱스는 사용자가 직접 특정 테이블의 열에 지정할 수도 있지만 열이 기본키(primart key)또는 고유키(unique key)일 경우에 자동으로 생성된다.
<br/>

> 인덱스 생성

- 오라클 데이터베이스에서 자동으로 생성해 주는 인덱스 외에 사용자가 직접 인덱스를 만들 때는 CREATE문을 사용한다. CREATE문에서는 인덱스를 생성할 테이블 및 열을 지정하며 열은 하나 또는 여러 개 지정할 수 있다. 지정한 각 열별로 인덱스 정렬 순서를 정할 수도 있다.
```sql
CREATE INDEX 인덱스 이름
	ON 테이블 이름(열 이름1 ASC or DESC,
    			 열 이름2 ASC or DESC,
                 ...				  );
```

- 인덱스의 정렬 옵션을 지정하지 않으면 기본값은 오름차순(ASC)으로 지정된다.
- 목적에 따라 여러 방식으로 생성할 수 있는 인덱스의 종류

| 방식 | 사용 |
|:----:|:----------------------:|
| 단일 인덱스(single index) | CREATE INDEX IDX_NAME<br/> ON EMP(SAL); |
| 복합 인덱스(concatenated index)<br/> 결합 인덱스(composite index)<br/> - 두 개 이상 열로 만들어지는 인덱스<br/> - WHERE절의 두 열이 AND 연산으로 묶이는 경우 | CREATE INDEX IDX_NAME<br/> ON EMP(SAL, ENAME, ...); |
| 고유 인덱스(unique index)<br/> - 열에 중복 데이터가 없을 때 사용<br/> - UNIQUE 키워드를 지정하지 않으면 비고유 인덱스(non unique index)가 기본값 | CREATE UNIQUE INDEX IDX_NAME<br/> ON EMP(EMPNO); |
| 함수 기반 인덱스(function based index)<br/> - 열에 산술식 같은 데이터 가공이 진행된 결과로 인덱스 생성 | CREATE INDEX IDX_NAME<br/> ON EMP(SAL * 12 + COMM); |
비트맵 인덱스(bitmap index)<br/> - 데이터 종류가 적고 같은 데이터가 많이 존재할 때 주로 사용 | CREATE BITMAP INDEX IDX_NAME<br/> ON EMP(JOB); |
<br/>

> 인덱스 삭제

- 인덱스 삭제는 DROP 명령어를 사용한다.
```sql
DROP INDEX 인덱스 이름;
```
- 인덱스는 데이터 접근 및 검색 속도 향상을 위해 사용하는 객체이지만 인덱스 생성이 항상 좋은 결과로 이어지지는 않는다. 정확한 데이터 분석에 기반을 두지 않은 인덱스의 무분별한 생성은 오히려 성능을 떨어뜨리는 원인이 되기도 한다.
인덱스는 데이터 종류, 분포도, 조회하는 SQL의 구성, 데이터 조작 관련 SQL문의 작업 빈도, 검색 결과가 전체 데이터에서 차지하는 비중 등 많은 요소를 고려하여 생성한다.

---
